<html>
<head>
	<script src="materialize.min.js" type="text/javascript"></script>
  <script src="jquery-3.3.1.min.js" type="text/javascript"></script>

  <link rel="stylesheet" href="materialize.min.css">
</head>
<style>
pre {
  background-color:#efefef;
  border-radius:7px;
  padding-left:20px;
}
.content {
  padding-top:2em;
}
button {
	font-size:20px;
}
.article {
  display:none;
}
</style>
<body>
  <nav>
    <div class="nav-wrapper">
      <div class="container">
        <a href="https://github.com/rook2pawn/choo-examples" class="brand-logo right"><img style="margin-right: 20px;margin-top: 16px;" src="GitHub-Mark-32px.png"></a>
        <ul id="nav-mobile" class="left hide-on-med-and-down">
          <li><a href="#">Nanocomponent Nested Buttons</a></li>
          <li><a href="#input-example">Input Example</a></li>
          <li><a href="#submit-confirm">Submit-Confirm Example</a></li>
        </ul>
      </div>
    </div>
  </nav>
  <div id="appEntry" class='container content'>
  </div>
<div id='c1' class='container article'>
    <pre><code class="javascript language-javascript">
var choo = require('choo')
var html = require('choo/html')
var Nanocomponent = require('nanocomponent')

class Button extends Nanocomponent {
  constructor () {
    super()
    this.button = null
  }

  createElement (button) {
    // important we use a copy because if we change state
    // later we don't want that to effect this directly
    this.button = Object.assign({}, button);
    return html`
      &lt;button style="background-color: ${button.backgroundColor}; color: ${button.color}"&gt;
        Click Me
      &lt;/button&gt;
    `
  }

  update (newButton) {
    return newButton.backgroundColor !== this.button.backgroundColor
  }
}

class ButtonManager extends Nanocomponent {
  constructor () {
    super()
    this.buttons = null
  }

  createElement (buttons) {
    this.buttons = buttons.map((button) =&gt; new Button)
    return html`&lt;div&gt;${this.buttons.map((button,idx) =&gt; button.render(buttons[idx]))}&lt;/div&gt;`
  }

  update (newButtons) {
    newButtons.forEach((newButton,idx) =&gt; {
      this.buttons[idx].render(newButton)
    })
    return false;
  }
}

var bm = new ButtonManager;
var app = choo()
app.route('/', mainView)
app.mount('body')


var mr = require('mrcolor');
const invert = require('invert-color');

var getColor = mr();
const getRandomColor = function() {
  var color = getColor().rgb();

  var foregroundColor= invert(color)
  var backgroundColor = `rgb(${color.join(',')})`;
  return {color:foregroundColor, backgroundColor}
}

app.use((state, emitter) =&gt; {
  state.buttons = Array(5).fill().map(() =&gt; getRandomColor());
  setInterval(() =&gt; {
    const index = ~~(Math.random()*state.buttons.length)
    const colorObj = getRandomColor();
    state.buttons[index].color = colorObj.color;
    state.buttons[index].backgroundColor = colorObj.backgroundColor;
    emitter.emit('render');
  }, 500)
})
function mainView (state, emit) {
  return html`&lt;body&gt;
  ${bm.render(state.buttons)}
  &lt;/body&gt;`
}
    </code></pre>
</div>
<div id="c2" class="container article">

  <pre><code>
var html = require('choo/html')
var choo = require('choo')

var app = choo()
app.use(titleStore)
app.route('/', titleView)
app.mount('body')

function titleView (state, emit) {
  return html`
    &lt;body&gt;
    &lt;h1&gt;${state.title}&lt;/h1&gt;
    &lt;input
      type="text"
      value="${state.title}"
      oninput=${oninput} /&gt;
    &lt;/body&gt;
  `

  function oninput (e) {
    emit('update', e.target.value)
  }
}

function titleStore (state, emitter) {
  state.title = "Set the title"
  emitter.on('update', function (title) {
    state.title = title;
    emitter.emit('render')
  })
}
</code></pre>

</div>
<div id="c3" class="container article">
<pre><code>
var html = require("choo/html");
var choo = require("choo");

var app = choo();

function confirmStore(state, emitter) {
  state.confirm = {
    button: "waiting"
  };
  emitter.on("maybe", function() {
    state.confirm.button = "confirm";
    emitter.emit("render");
  });

  emitter.on("cancel", function() {
    state.submit.field = "";
    state.confirm.button = "waiting";
    emitter.emit("render");
  });

  emitter.on("confirm", function() {
    state.confirm.button = "waiting";
    state.submit = {
      field: "",
      submitted: state.submit.field
    };
    emitter.emit("render");
  });
}

function submitStore(state, emitter) {
  state.submit = {
    field: "",
    submitted: ""
  };
  emitter.on("setField", function(value) {
    state.submit.field = value;
    emitter.emit("render");
  });
}
const Confirm = (state, emit) =&gt; {
  let isWaiting = (state.confirm.button === "waiting");
  if (isWaiting) {
    const isDisabled = state.submit.field == "";
    return html`
      &lt;button onclick=${() =&gt; { emit("maybe") }} disabled=${isDisabled}&gt;Submit&lt;/button&gt;`;
  } else {
    return html`
      &lt;span&gt;
        &lt;button onclick=${() =&gt; {
          emit("cancel");
        }}&gt;Cancel&lt;/button&gt;
        &lt;button onclick=${() =&gt; {
          emit("confirm");
        }}&gt;Confirm&lt;/button&gt;
      &lt;/span&gt;
    `;
  }
};
const Submission = (state, emit) =&gt; {
  const onChange = e =&gt; {
    emit("setField", e.target.value);
  };
  return html`
  &lt;body&gt;
    &lt;input value="${state.submit.field}" oninput=${onChange}/&gt;
    ${Confirm(state, emit)}
    &lt;p&gt;Submitted value: ${state.submit.submitted}&lt;/p&gt;
  &lt;/body&gt;
  `;
};
app.use(confirmStore);
app.use(submitStore);
app.route("/", Submission);
app.mount("body");
</code></pre>
</div>
	<script src="bundle.js"></script>
</body>
</html>
