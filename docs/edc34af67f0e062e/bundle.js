!function(){var t=function t(e,n){for(var i=0;i<n.length;i++){var r=n[i];if(Array.isArray(r))t(e,r);else{if(("number"==typeof r||"boolean"==typeof r||r instanceof Date||r instanceof RegExp)&&(r=r.toString()),"string"==typeof r){if(/^[\n\r\s]+$/.test(r))continue;if(e.lastChild&&"#text"===e.lastChild.nodeName){e.lastChild.nodeValue+=r;continue}r=document.createTextNode(r)}r&&r.nodeType&&e.appendChild(r)}}},e={};function n(t){if(!(this instanceof n))return new n(t);"number"==typeof t&&(t={max:t}),t||(t={}),this.cache={},this.head=this.tail=null,this.length=0,this.max=t.max||1e3,this.maxAge=t.maxAge||0}e=n,Object.defineProperty(n.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),n.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},n.prototype.remove=function(t){if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){var e=this.cache[t];return delete this.cache[t],this._unlink(t,e.prev,e.next),e.value}},n.prototype._unlink=function(t,e,n){this.length--,0===this.length?this.head=this.tail=null:this.head===t?(this.head=e,this.cache[this.head].next=null):this.tail===t?(this.tail=n,this.cache[this.tail].prev=null):(this.cache[e].next=n,this.cache[n].prev=e)},n.prototype.peek=function(t){if(this.cache.hasOwnProperty(t)){var e=this.cache[t];if(this._checkAge(t,e))return e.value}},n.prototype.set=function(t,e){var n;if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){if((n=this.cache[t]).value=e,this.maxAge&&(n.modified=Date.now()),t===this.head)return e;this._unlink(t,n.prev,n.next)}else n={value:e,modified:0,next:null,prev:null},this.maxAge&&(n.modified=Date.now()),this.cache[t]=n,this.length===this.max&&this.evict();return this.length++,n.next=null,n.prev=this.head,this.head&&(this.cache[this.head].next=t),this.head=t,this.tail||(this.tail=t),e},n.prototype._checkAge=function(t,e){return!(this.maxAge&&Date.now()-e.modified>this.maxAge&&(this.remove(t),1))},n.prototype.get=function(t){if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){var e=this.cache[t];if(this._checkAge(t,e))return this.head!==t&&(t===this.tail?(this.tail=e.next,this.cache[this.tail].prev=null):this.cache[e.prev].next=e.next,this.cache[e.next].prev=e.prev,this.cache[this.head].next=t,e.prev=this.head,e.next=null,this.head=t),e.value}},n.prototype.evict=function(){this.tail&&this.remove(this.tail)};var i={};function r(t,n,i){this.cache="number"==typeof i?new e(i):i||new e(100),this.state=t,this.emit=n}function o(t){return new(t.bind.apply(t,arguments))}"function"==typeof Symbol&&Symbol.iterator,i=r,r.prototype.render=function(t,e){var n=this.cache.get(e);if(!n){for(var i=[],r=2,s=arguments.length;r<s;r++)i.push(arguments[r]);i.unshift(t,e,this.state,this.emit),n=o.apply(o,i),this.cache.set(e,n)}return n},"function"==typeof Symbol&&Symbol.iterator;var s,a=function(t){var e=document.readyState;if("complete"===e||"interactive"===e)return setTimeout(t,0);document.addEventListener("DOMContentLoaded",function(){t()})};"function"==typeof Symbol&&Symbol.iterator;var h="undefined"!=typeof window;function u(t){this.hasWindow=t,this.hasIdle=this.hasWindow&&window.requestIdleCallback,this.method=this.hasIdle?window.requestIdleCallback.bind(window):this.setTimeout,this.scheduled=!1,this.queue=[]}u.prototype.push=function(t){this.queue.push(t),this.schedule()},u.prototype.schedule=function(){if(!this.scheduled){this.scheduled=!0;var t=this;this.method(function(e){for(;t.queue.length&&e.timeRemaining()>0;)t.queue.shift()(e);t.scheduled=!1,t.queue.length&&t.schedule()})}},u.prototype.setTimeout=function(t){setTimeout(t,0,{timeRemaining:function(){return 1}})},s=function(){var t;return h?(window._nanoScheduler||(window._nanoScheduler=new u(!0)),t=window._nanoScheduler):t=new u,t},"function"==typeof Symbol&&Symbol.iterator;var c,l=s();d.disabled=!0;try{c=window.performance,d.disabled="true"===window.localStorage.DISABLE_NANOTIMING||!c.mark}catch(t){}function d(t){if(d.disabled)return f;var e=(1e4*c.now()).toFixed()%Number.MAX_SAFE_INTEGER,n="start-"+e+"-"+t;function i(i){var r="end-"+e+"-"+t;c.mark(r),l.push(function(){var o=null;try{var s=t+" ["+e+"]";c.measure(s,n,r),c.clearMarks(n),c.clearMarks(r)}catch(t){o=t}i&&i(o,t)})}return c.mark(n),i.uuid=e,i}function f(t){t&&l.push(function(){t(new Error("nanotiming: performance API unavailable"))})}var p=d,m=function(t,e,n){var i,r=t.length;if(!(e>=r||0===n)){var o=r-(n=e+n>r?r-e:n);for(i=e;i<o;++i)t[i]=t[i+n];t.length=o}},v={};"function"==typeof Symbol&&Symbol.iterator;function y(t){if(!(this instanceof y))return new y(t);this._name=t||"nanobus",this._starListeners=[],this._listeners={}}v=y,y.prototype.emit=function(t){for(var e=[],n=1,i=arguments.length;n<i;n++)e.push(arguments[n]);var r=p(this._name+"('"+t+"')"),o=this._listeners[t];return o&&o.length>0&&this._emit(this._listeners[t],e),this._starListeners.length>0&&this._emit(this._starListeners,t,e,r.uuid),r(),this},y.prototype.on=y.prototype.addListener=function(t,e){return"*"===t?this._starListeners.push(e):(this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)),this},y.prototype.prependListener=function(t,e){return"*"===t?this._starListeners.unshift(e):(this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].unshift(e)),this},y.prototype.once=function(t,e){var n=this;return this.on(t,function i(){e.apply(n,arguments),n.removeListener(t,i)}),this},y.prototype.prependOnceListener=function(t,e){var n=this;return this.prependListener(t,function i(){e.apply(n,arguments),n.removeListener(t,i)}),this},y.prototype.removeListener=function(t,e){return"*"===t?(this._starListeners=this._starListeners.slice(),n(this._starListeners,e)):(void 0!==this._listeners[t]&&(this._listeners[t]=this._listeners[t].slice()),n(this._listeners[t],e));function n(t,e){if(t){var n=t.indexOf(e);return-1!==n?(m(t,n,1),!0):void 0}}},y.prototype.removeAllListeners=function(t){return t?"*"===t?this._starListeners=[]:this._listeners[t]=[]:(this._starListeners=[],this._listeners={}),this},y.prototype.listeners=function(t){var e="*"!==t?this._listeners[t]:this._starListeners,n=[];if(e)for(var i=e.length,r=0;r<i;r++)n.push(e[r]);return n},y.prototype._emit=function(t,e,n,i){if(void 0!==t&&0!==t.length){void 0===n&&(n=e,e=null),e&&(n=void 0!==i?[e].concat(n,i):[e].concat(n));for(var r=t.length,o=0;o<r;o++){var s=t[o];s.apply(s,n)}}},"function"==typeof Symbol&&Symbol.iterator;var w=/(noopener|noreferrer) (noopener|noreferrer)/,b=/^[\w-_]+:/;"function"==typeof Symbol&&Symbol.iterator;var _=function(){return window.location.pathname.replace(/\/$/,"")+window.location.hash.replace(/^#/,"/")},g=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","oncontextmenu","onfocusin","onfocusout"],S=g.length;function A(t,e,n){t[n]!==e[n]&&(e[n]=t[n],t[n]?e.setAttribute(n,""):e.removeAttribute(n))}var E=function(t,e){var n=t.nodeType,i=t.nodeName;1===n&&function(t,e){for(var n=e.attributes,i=t.attributes,r=null,o=null,s=null,a=null,h=i.length-1;h>=0;--h)s=(a=i[h]).name,r=a.namespaceURI,o=a.value,r?(s=a.localName||s,e.getAttributeNS(r,s)!==o&&e.setAttributeNS(r,s,o)):e.hasAttribute(s)?e.getAttribute(s)!==o&&("null"===o||"undefined"===o?e.removeAttribute(s):e.setAttribute(s,o)):e.setAttribute(s,o);for(var u=n.length-1;u>=0;--u)!1!==(a=n[u]).specified&&(s=a.name,(r=a.namespaceURI)?(s=a.localName||s,t.hasAttributeNS(r,s)||e.removeAttributeNS(r,s)):t.hasAttributeNS(null,s)||e.removeAttribute(s))}(t,e),3!==n&&8!==n||e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),"INPUT"===i?function(t,e){var n=t.value,i=e.value;A(t,e,"checked"),A(t,e,"disabled"),n!==i&&(e.setAttribute("value",n),e.value=n),"null"===n&&(e.value="",e.removeAttribute("value")),t.hasAttributeNS(null,"value")?"range"===e.type&&(e.value=n):e.removeAttribute("value")}(t,e):"OPTION"===i?function(t,e){A(t,e,"selected")}(t,e):"TEXTAREA"===i&&function(t,e){var n=t.value;if(n!==e.value&&(e.value=n),e.firstChild&&e.firstChild.nodeValue!==n){if(""===n&&e.firstChild.nodeValue===e.placeholder)return;e.firstChild.nodeValue=n}}(t,e),function(t,e){for(var n=0;n<S;n++){var i=g[n];t[i]?e[i]=t[i]:e[i]&&(e[i]=void 0)}}(t,e)};"function"==typeof Symbol&&Symbol.iterator;var N=3;function T(t,e){return t.id?t.id===e.id:t.isSameNode?t.isSameNode(e):t.tagName===e.tagName&&t.type===N&&t.nodeValue===e.nodeValue}var L=function(t,e){return function t(e,n){return n?e?e.isSameNode&&e.isSameNode(n)?n:e.tagName!==n.tagName?e:(E(e,n),function(e,n){for(var i,r,o,s,a=0,h=0;i=n.childNodes[h],r=e.childNodes[h-a],i||r;h++)if(r)if(i)if(T(r,i))(o=t(r,i))!==i&&(n.replaceChild(o,i),a++);else{s=null;for(var u=h;u<n.childNodes.length;u++)if(T(n.childNodes[u],r)){s=n.childNodes[u];break}s?((o=t(r,s))!==s&&a++,n.insertBefore(o,i)):r.id||i.id?(n.insertBefore(r,i),a++):(o=t(r,i))!==i&&(n.replaceChild(o,i),a++)}else n.appendChild(r),a++;else n.removeChild(i),h--}(e,n),n):null:e}(e,t)};"function"==typeof Symbol&&Symbol.iterator;var x=/([^?=&]+)(=([^&]*))?/g;"function"==typeof Symbol&&Symbol.iterator;var O=function(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)C.call(n,i)&&(t[i]=n[i])}return t},C=Object.prototype.hasOwnProperty,R=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)k.call(n,i)&&(t[i]=n[i])}return t},k=Object.prototype.hasOwnProperty,I={};"function"==typeof Symbol&&Symbol.iterator;function P(){if(!(this instanceof P))return new P;this.trie={nodes:{}}}I=P,P.prototype.create=function(t){var e=t.replace(/^\//,"").split("/");return function t(n,i){var r=e.hasOwnProperty(n)&&e[n];if(!1===r)return i;var o=null;return/^:|^\*/.test(r)?(i.nodes.hasOwnProperty("$$")?o=i.nodes.$$:(o={nodes:{}},i.nodes.$$=o),"*"===r[0]&&(i.wildcard=!0),i.name=r.replace(/^:|^\*/,"")):i.nodes.hasOwnProperty(r)?o=i.nodes[r]:(o={nodes:{}},i.nodes[r]=o),t(n+1,o)}(0,this.trie)},P.prototype.match=function(t){var e=t.replace(/^\//,"").split("/"),n={},i=function t(i,r){if(void 0!==r){var o=e[i];if(void 0===o)return r;if(r.nodes.hasOwnProperty(o))return t(i+1,r.nodes[o]);if(r.name){try{n[r.name]=decodeURIComponent(o)}catch(e){return t(i,void 0)}return t(i+1,r.nodes.$$)}if(r.wildcard){try{n.wildcard=decodeURIComponent(e.slice(i).join("/"))}catch(e){return t(i,void 0)}return r.nodes.$$}return t(i+1)}}(0,this.trie);if(i)return(i=O(i)).params=n,i},P.prototype.mount=function(t,e){var n=t.replace(/^\//,"").split("/"),i=null,r=null;if(1===n.length)r=n[0],i=this.create(r);else{var o=n.join("/");r=n[0],i=this.create(o)}R(i.nodes,e.nodes),e.name&&(i.name=e.name),i.nodes[""]&&(Object.keys(i.nodes[""]).forEach(function(t){"nodes"!==t&&(i[t]=i.nodes[""][t])}),R(i.nodes,i.nodes[""].nodes),delete i.nodes[""].nodes)},"function"==typeof Symbol&&Symbol.iterator;var D=function t(e){if(!(this instanceof t))return new t(e);var n=(e||"").replace(/^\//,""),i=I();return r._trie=i,r.on=function(t,e){(t=t||"/",e.route=t,e&&e._wayfarer&&e._trie)?i.mount(t,e._trie.trie):i.create(t).cb=e;return r},r.emit=r,r.match=o,r._wayfarer=!0,r;function r(t){var e=o(t),n=new Array(arguments.length);n[0]=e.params;for(var i=1;i<n.length;i++)n[i]=arguments[i];return e.cb.apply(e.cb,n)}function o(t){var e=i.match(t);if(e&&e.cb)return new s(e);var r=i.match(n);if(r&&r.cb)return new s(r);throw new Error("route '"+t+"' did not match")}function s(t){this.cb=t.cb,this.route=t.cb.route,this.params=t.params}},V={},$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M=/file:\/\//.test("object"===("undefined"==typeof window?"undefined":$(window))&&window.location&&window.location.origin),q=new RegExp("^(file://|/)(.*.html?/?)?"),U=new RegExp("^(http(s)?(://))?(www.)?[a-zA-Z0-9-_.]+(:[0-9]{1,5})?(/{1})?"),j=new RegExp("#"),G=new RegExp("[?].*$");function H(t){if(!(this instanceof H))return new H(t);t=t||{},this.router=D(t.default||"/404")}function W(t,e){return t=e?t.replace(q,""):t.replace(U,""),decodeURI(t.replace(G,"").replace(j,"/"))}V=H,H.prototype.on=function(t,e){t=t.replace(/^[#/]/,""),this.router.on(t,e)},H.prototype.emit=function(t){return t=W(t,M),this.router.emit(t)},H.prototype.match=function(t){return t=W(t,M),this.router.match(t)};var K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B=z,F={};function z(t){if(!(this instanceof z))return new z(t);t=t||{};var e=this;this._events={DOMCONTENTLOADED:"DOMContentLoaded",DOMTITLECHANGE:"DOMTitleChange",REPLACESTATE:"replaceState",PUSHSTATE:"pushState",NAVIGATE:"navigate",POPSTATE:"popState",RENDER:"render"},this._historyEnabled=void 0===t.history||t.history,this._hrefEnabled=void 0===t.href||t.href,this._hasWindow="undefined"!=typeof window,this._createLocation=_,this._cache=t.cache,this._loaded=!1,this._stores=[],this._tree=null;var n={events:this._events,components:{}};this._hasWindow?(this.state=window.initialState?O(window.initialState,n):n,delete window.initialState):this.state=n,this.router=V({curry:!0}),this.emitter=v("choo.emit"),this.emit=this.emitter.emit.bind(this.emitter),this._hasWindow&&(this.state.title=document.title),this.emitter.prependListener(this._events.DOMTITLECHANGE,function(t){e.state.title=t,e._hasWindow&&(document.title=t)})}z.prototype.route=function(t,e){this.router.on(t,e)},z.prototype.use=function(t){var e=this;this._stores.push(function(n){var i="choo.use";i=t.storeName?i+"("+t.storeName+")":i;var r=p(i);t(n,e.emitter,e),r()})},z.prototype.start=function(){var t,e,n=this;return this._historyEnabled&&(this.emitter.prependListener(this._events.NAVIGATE,function(){n._matchRoute(),n._loaded&&(n.emitter.emit(n._events.RENDER),setTimeout(function(t,e){if(t)try{var n=document.querySelector(t);n&&n.scrollIntoView(e)}catch(t){}}.bind(null,window.location.hash),0))}),this.emitter.prependListener(this._events.POPSTATE,function(){n.emitter.emit(n._events.NAVIGATE)}),this.emitter.prependListener(this._events.PUSHSTATE,function(t){window.history.pushState(F,null,t),n.emitter.emit(n._events.NAVIGATE)}),this.emitter.prependListener(this._events.REPLACESTATE,function(t){window.history.replaceState(F,null,t),n.emitter.emit(n._events.NAVIGATE)}),window.onpopstate=function(){n.emitter.emit(n._events.POPSTATE)},n._hrefEnabled&&(t=function(t){var e=t.href;e!==window.location.href&&n.emitter.emit(n._events.PUSHSTATE,e)},e=e||window.document,window.addEventListener("click",function(n){if(!(n.button&&0!==n.button||n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.defaultPrevented)){var i=function t(n){if(n&&n!==e)return"a"!==n.localName||void 0===n.href?t(n.parentNode):n}(n.target);i&&(window.location.origin!==i.origin||i.hasAttribute("download")||"_blank"===i.getAttribute("target")&&w.test(i.getAttribute("rel"))||b.test(i.getAttribute("href"))||(n.preventDefault(),t(i)))}}))),this._setCache(this.state),this._stores.forEach(function(t){t(n.state)}),this._matchRoute(),this._tree=this._prerender(this.state),this.emitter.prependListener(n._events.RENDER,function(t,e){e||(e=window.requestAnimationFrame);var n=!1,i=null;return function(){null!==i||n||(n=!0,e(function(){n=!1;for(var e=i.length,r=new Array(e),o=0;o<e;o++)r[o]=i[o];t.apply(t,r),i=null})),i=arguments}}(function(){var t=p("choo.render"),e=n._prerender(n.state),i=p("choo.morph");L(n._tree,e),i(),t()})),a(function(){n.emitter.emit(n._events.DOMCONTENTLOADED),n._loaded=!0}),this._tree},z.prototype.mount=function(t){if("object"!==("undefined"==typeof window?"undefined":K(window)))return this.selector=t,this;var e=this;a(function(){var n=p("choo.render"),i=e.start();e._tree="string"==typeof t?document.querySelector(t):t;var r=p("choo.morph");L(e._tree,i),r(),n()})},z.prototype.toString=function(t,e){this.state=O(this.state,e||{});var n=this;this._setCache(this.state),this._stores.forEach(function(t){t(n.state)}),this._matchRoute(t);var i=this._prerender(this.state);return"string"==typeof i.outerHTML?i.outerHTML:i.toString()},z.prototype._matchRoute=function(t){var e,n;t?(e=t.replace(/\?.+$/,""),n=t):(e=this._createLocation(),n=window.location.search);var i,r=this.router.match(e);return this._handler=r.cb,this.state.href=e,this.state.query=(i={},n.replace(/^.*\?/,"").replace(x,function(t,e,n,r){i[decodeURIComponent(e)]=decodeURIComponent(r)}),i),this.state.route=r.route,this.state.params=r.params,this.state},z.prototype._prerender=function(t){var e=p("choo.prerender('"+t.route+"')"),n=this._handler(t,this.emit);return e(),n},z.prototype._setCache=function(t){var e=new i(t,this.emitter.emit.bind(this.emitter),this._cache);function n(t,n){for(var i=[],r=0,o=arguments.length;r<o;r++)i.push(arguments[r]);return e.render.apply(e,i)}t.cache=n,n.toJSON=function(){return null}};var X=B();X.route("/choo-examples",function(e,n){return function(){var e=document.createElement("body"),n=document.createElement("h2");t(n,["Hello World"]);var i=document.createElement("a");return i.setAttribute("href","#second"),t(i,["\n        Navigate to the next route.\n      "]),t(e,["\n      ",n,"\n      ",i,"\n    "]),e}()}),X.route("/choo-examples/second",function(e){return function(){var e=document.createElement("body"),n=document.createElement("a");return n.setAttribute("href",arguments[0]),t(n,["\n        Navigate back, ",arguments[1],".\n      "]),t(e,["\n      ",n,"\n    "]),e}("/choo-examples",e.title)}),X.mount("body")}();
//# sourceMappingURL=bundle.js.map